From: Brett Neumeier <brett@neumeier.us>
Date: Fri, 20 Feb 2009 07:50:03 -0600
Subject: [PATCH] posix patch from clfs, respun for 4.3.3

---
 contrib/test_summary                       |    2 +-
 gcc/configure                              |    2 +-
 gcc/configure.ac                           |    2 +-
 gcc/testsuite/ada/acats/run_all.sh         |    2 +-
 libgomp/acinclude.m4                       |    2 +-
 libgomp/configure                          |    2 +-
 libjava/classpath/configure                |    2 +-
 libjava/classpath/ltcf-c.sh                |    2 +-
 libjava/classpath/ltcf-gcj.sh              |    2 +-
 libjava/classpath/m4/ax_create_stdint_h.m4 |    2 +-
 libjava/configure                          |    4 ++--
 libjava/mingwld.m4                         |    4 ++--
 libstdc++-v3/acinclude.m4                  |    2 +-
 libstdc++-v3/configure                     |   22 +++++++++++-----------
 14 files changed, 26 insertions(+), 26 deletions(-)

diff --git a/contrib/test_summary b/contrib/test_summary
index 9866435..fcd7958 100755
--- a/contrib/test_summary
+++ b/contrib/test_summary
@@ -107,7 +107,7 @@ configflags == "" {
     srcdir = configflags;
     sub(/\/configure .*/, "", srcdir);
     printf "LAST_UPDATED: ";
-    system("tail -1 " srcdir "/LAST_UPDATED");
+    system("tail -n 1 " srcdir "/LAST_UPDATED");
     print "";
 
     sub(/^[^ ]*\/configure */, " ", configflags);
diff --git a/gcc/configure b/gcc/configure
index f7d4161..03c5783 100755
--- a/gcc/configure
+++ b/gcc/configure
@@ -20245,7 +20245,7 @@ EOF
   # Therefore, use diff -b for the comparisons.
   if test x$gcc_cv_objdump != x \
   && $gcc_cv_objdump -s -j .eh_frame conftest.o 2>/dev/null \
-     | tail -3 > conftest.got \
+     | tail -n 3 > conftest.got \
   && { diff -b conftest.lit conftest.got > /dev/null 2>&1 \
     || diff -b conftest.big conftest.got > /dev/null 2>&1; }
   then
diff --git a/gcc/configure.ac b/gcc/configure.ac
index 057c480..702d59e 100644
--- a/gcc/configure.ac
+++ b/gcc/configure.ac
@@ -2241,7 +2241,7 @@ EOF
   # Therefore, use diff -b for the comparisons.
   if test x$gcc_cv_objdump != x \
   && $gcc_cv_objdump -s -j .eh_frame conftest.o 2>/dev/null \
-     | tail -3 > conftest.got \
+     | tail -n 3 > conftest.got \
   && { diff -b conftest.lit conftest.got > /dev/null 2>&1 \
     || diff -b conftest.big conftest.got > /dev/null 2>&1; }
   then
diff --git a/gcc/testsuite/ada/acats/run_all.sh b/gcc/testsuite/ada/acats/run_all.sh
index ddd4da0..91accff 100755
--- a/gcc/testsuite/ada/acats/run_all.sh
+++ b/gcc/testsuite/ada/acats/run_all.sh
@@ -68,7 +68,7 @@ find_main () {
   ls ${i}?.adb > ${i}.lst 2> /dev/null
   ls ${i}*m.adb >> ${i}.lst 2> /dev/null
   ls ${i}.adb >> ${i}.lst 2> /dev/null
-  main=`tail -1 ${i}.lst`
+  main=`tail -n 1 ${i}.lst`
 }
 
 EXTERNAL_OBJECTS=""
diff --git a/libgomp/acinclude.m4 b/libgomp/acinclude.m4
index acf47df..4ee8ba6 100644
--- a/libgomp/acinclude.m4
+++ b/libgomp/acinclude.m4
@@ -147,7 +147,7 @@ AC_DEFUN([LIBGOMP_CHECK_LINKER_FEATURES], [
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
   changequote(,)
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n 1 | \
          sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
   changequote([,])
   libgomp_gnu_ld_version=`echo $ldver | \
diff --git a/libgomp/configure b/libgomp/configure
index 7f4be76..755880f 100755
--- a/libgomp/configure
+++ b/libgomp/configure
@@ -17600,7 +17600,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
 
-  ldver=`$LD --version 2>/dev/null | head -1 | \
+  ldver=`$LD --version 2>/dev/null | head -n 1 | \
          sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
   libgomp_gnu_ld_version=`echo $ldver | \
diff --git a/libjava/classpath/configure b/libjava/classpath/configure
index c72bb75..c9b89f1 100755
--- a/libjava/classpath/configure
+++ b/libjava/classpath/configure
@@ -29126,7 +29126,7 @@ echo "${ECHO_T}$ac_cv_type_intmax_t" >&6
 fi # shortcircut to system "stdint.h"
 # ------------------ PREPARE VARIABLES ------------------------------
 if test "$GCC" = "yes" ; then
-ac_cv_stdint_message="using gnu compiler "`$CC --version | head -1`
+ac_cv_stdint_message="using gnu compiler "`$CC --version | head -n 1`
 else
 ac_cv_stdint_message="using $CC"
 fi
diff --git a/libjava/classpath/ltcf-c.sh b/libjava/classpath/ltcf-c.sh
index 5eb05db..2df14d5 100644
--- a/libjava/classpath/ltcf-c.sh
+++ b/libjava/classpath/ltcf-c.sh
@@ -153,7 +153,7 @@ EOF
     # If the export-symbols file already is a .def file (1st line
     # is EXPORTS), use it as is.
     # If DATA tags from a recent dlltool are present, honour them!
-    archive_expsym_cmds='if test "x`head -1 $export_symbols`" = xEXPORTS; then
+    archive_expsym_cmds='if test "x`head -n 1 $export_symbols`" = xEXPORTS; then
         cp $export_symbols $output_objdir/$soname-def;
       else
         echo EXPORTS > $output_objdir/$soname-def;
diff --git a/libjava/classpath/ltcf-gcj.sh b/libjava/classpath/ltcf-gcj.sh
index 3f1c281..2422895 100644
--- a/libjava/classpath/ltcf-gcj.sh
+++ b/libjava/classpath/ltcf-gcj.sh
@@ -156,7 +156,7 @@ EOF
     # If the export-symbols file already is a .def file (1st line
     # is EXPORTS), use it as is.
     # If DATA tags from a recent dlltool are present, honour them!
-    archive_expsym_cmds='if test "x`head -1 $export_symbols`" = xEXPORTS; then
+    archive_expsym_cmds='if test "x`head -n 1 $export_symbols`" = xEXPORTS; then
         cp $export_symbols $output_objdir/$soname-def;
       else
         echo EXPORTS > $output_objdir/$soname-def;
diff --git a/libjava/classpath/m4/ax_create_stdint_h.m4 b/libjava/classpath/m4/ax_create_stdint_h.m4
index 453af07..7868464 100644
--- a/libjava/classpath/m4/ax_create_stdint_h.m4
+++ b/libjava/classpath/m4/ax_create_stdint_h.m4
@@ -217,7 +217,7 @@ AC_CHECK_TYPE(intmax_t,,,[#include <$ac_cv_header_stdint>])
 fi # shortcircut to system "stdint.h"
 # ------------------ PREPARE VARIABLES ------------------------------
 if test "$GCC" = "yes" ; then
-ac_cv_stdint_message="using gnu compiler "`$CC --version | head -1`
+ac_cv_stdint_message="using gnu compiler "`$CC --version | head -n 1`
 else
 ac_cv_stdint_message="using $CC"
 fi
diff --git a/libjava/configure b/libjava/configure
index a15cae8..a087d0a 100755
--- a/libjava/configure
+++ b/libjava/configure
@@ -18673,8 +18673,8 @@ echo "$as_me:$LINENO: checking whether 'ld' is at least 2.13" >&5
 echo $ECHO_N "checking whether 'ld' is at least 2.13... $ECHO_C" >&6
 LD_PROG=`$CC --print-prog-name=ld`
 LD_VERSION=`$LD_PROG --version`
-LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
-LD_VERSION_MINOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 2`
+LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -n -1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
+LD_VERSION_MINOR=`echo "$LD_VERSION" | head -n -1 | cut -d '.' -f 2`
 if expr "$LD_VERSION_MAJOR" \> 2 > /dev/null; then
   LD_OK="ok"
 else
diff --git a/libjava/mingwld.m4 b/libjava/mingwld.m4
index 9406798..d6cc6ad 100644
--- a/libjava/mingwld.m4
+++ b/libjava/mingwld.m4
@@ -3,8 +3,8 @@ AC_DEFUN([CHECK_FOR_BROKEN_MINGW_LD],
 AC_MSG_CHECKING(whether 'ld' is at least 2.13)
 LD_PROG=`$CC --print-prog-name=ld`
 LD_VERSION=`$LD_PROG --version`
-LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
-LD_VERSION_MINOR=`echo "$LD_VERSION" | head -1 | cut -d '.' -f 2`
+LD_VERSION_MAJOR=`echo "$LD_VERSION" | head -n 1 | cut -d '.' -f 1 | cut -d ' ' -f 4`
+LD_VERSION_MINOR=`echo "$LD_VERSION" | head -n 1 | cut -d '.' -f 2`
 if expr "$LD_VERSION_MAJOR" \> 2 > /dev/null; then
   LD_OK="ok"
 else
diff --git a/libstdc++-v3/acinclude.m4 b/libstdc++-v3/acinclude.m4
index 3b06899..e8b039a 100644
--- a/libstdc++-v3/acinclude.m4
+++ b/libstdc++-v3/acinclude.m4
@@ -234,7 +234,7 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [
   if test x"$with_gnu_ld" = x"yes"; then
     AC_MSG_CHECKING([for ld version])
     changequote(,)
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n 1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
     changequote([,])
     glibcxx_gnu_ld_version=`echo $ldver | \
diff --git a/libstdc++-v3/configure b/libstdc++-v3/configure
index d34267c..a03def7 100755
--- a/libstdc++-v3/configure
+++ b/libstdc++-v3/configure
@@ -17490,7 +17490,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -42215,7 +42215,7 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -84606,7 +84606,7 @@ done
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -85622,7 +85622,7 @@ done
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -86610,7 +86610,7 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -109089,7 +109089,7 @@ done
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -109934,7 +109934,7 @@ done
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -110828,7 +110828,7 @@ done
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -112114,7 +112114,7 @@ echo "${ECHO_T}$glibcxx_cv_WRITEV" >&6
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -112850,7 +112850,7 @@ _ACEOF
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -113351,7 +113351,7 @@ done
     echo "$as_me:$LINENO: checking for ld version" >&5
 echo $ECHO_N "checking for ld version... $ECHO_C" >&6
 
-    ldver=`$LD --version 2>/dev/null | head -1 | \
+    ldver=`$LD --version 2>/dev/null | head -n -1 | \
            sed -e 's/GNU ld \(version \)\{0,1\}\(([^)]*) \)\{0,1\}\([0-9.][0-9.]*\).*/\3/'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
-- 
1.6.0.3

